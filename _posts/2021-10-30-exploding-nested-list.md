---
title: ë°ì´í„° í”„ë ˆì„ ë‚´ì— nestedëœ ë¦¬ìŠ¤íŠ¸ë¥¼ í™•ì¥í•˜ê¸°
tags: [nested-list, explode, pandas]
category: Pandas
aside:
  toc: true
show_category: true
---

Pandasì—ì„œ Nested listë¥¼ í¼ì¹˜ë ¤ë©´ í­íŒŒì‹œì¼œë²„ë¦¬ë©´ ë©ë‹ˆë‹¤. ğŸ’£

<!--more-->

## ğŸŒƒ ë°°ê²½

ë°ì´í„°í”„ë ˆì„ì„ ë‹¤ë£¨ë‹¤ë³´ë©´ ì»¬ëŸ¼ ë‚´ì— ë¦¬ìŠ¤íŠ¸ê°€ Nestedëœ í˜•íƒœê°€ ê°€ë” ìˆìŠµë‹ˆë‹¤. ìì£¼ ê²ªì„ ìˆ˜ ìˆëŠ” ì¼€ì´ìŠ¤ëŠ” ì•„ë‹ˆë¼ `pandas` ë‚´ì— ì´ê±¸ ì²˜ë¦¬í•˜ëŠ” ë©”ì„œë“œê°€ ìˆì„ê±°ë€ ìƒê°ì„ ì•ˆí•´ë´¤ëŠ”ë°ìš”. ì´ëŸ° ì¼€ì´ìŠ¤ì…ë‹ˆë‹¤.

```python
>>> df = pd.DataFrame({"col1":["A","B"], "col2":[["a", "b"],["b", "c"]]})

>>> df
  col1    col2
0    A  [a, b]
1    B  [b, c]
```

ì´ í˜•íƒœë¡œ ë§Œë“¤ì–´ì ¸ ìˆë‹¤ë©´ ë‘˜ ì¤‘ í•˜ë‚˜ì¼ê²ë‹ˆë‹¤. ì´ í˜•íƒœë¥¼ ê·¸ëŒ€ë¡œ ì“°ê±°ë‚˜, `col2` ì»¬ëŸ¼ì„ í¼ì³ì„œ ì´ ë„¤ ê°œì˜ í–‰ìœ¼ë¡œ ì´ë£¨ì–´ì§„ ë°ì´í„°í”„ë ˆì„ì„ ë§Œë“¤ê±°ë‚˜.

## ğŸ˜ í•´ê²°

### Numpyë§Œ ì‚¬ìš©í•˜ë©´

ì²˜ìŒì—” `numpy`ë§Œì„ ì‚¬ìš©í•´ì„œ ë°ì´í„°í”„ë ˆì„ì„ ì¬êµ¬ì„±í–ˆì—ˆìŠµë‹ˆë‹¤.

```python
>>> vals = np.array(df["col2"].tolist())
>>> key = np.repeat(df["col1"], vals.shape[1])
>>> pd.DataFrame(np.column_stack((key, vals.ravel())), columns=df.columns)

  col1 col2
0    A    a
1    A    b
2    B    b
3    B    c
```

ì»¨ì…‰ì€ ê°„ë‹¨í•©ë‹ˆë‹¤. Nested ë˜ì–´ ìˆëŠ” ì»¬ëŸ¼ì„ `ravel()` ë©”ì„œë“œë¥¼ í†µí•´ í¼ì¹˜ê³ , Keyê°€ ë˜ëŠ” ì»¬ëŸ¼ì„ Nested ë˜ì–´ ìˆëŠ” ë¦¬ìŠ¤íŠ¸ì˜ ê¸¸ì´ë§Œí¼ ë°˜ë³µí•˜ì—¬ column-wiseí•˜ê²Œ ë¶™ì—¬ì£¼ê¸°ë§Œ í–ˆìŠµë‹ˆë‹¤.

### Pandasë¥¼ ì‚¬ìš©í•˜ë©´

`numpy`ë§Œì„ ì‚¬ìš©í•˜ë˜ ì¤‘ `pandas`ì— ì´ëŸ° ì¼€ì´ìŠ¤ë¥¼ ì²˜ë¦¬í•´ì£¼ëŠ” ë©”ì„œë“œê°€ ìˆëŠ” ê²ƒì„ ì•Œì•˜ìŠµë‹ˆë‹¤. ê°„ë‹¨í•˜ê²Œ í•œ ì¤„ë§Œ ì“°ë©´ ë˜‘ê°™ì€ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
>>> df.explode("col2", ignore_index=True)

  col1 col2
0    A    a
1    A    b
2    B    b
3    B    c
```

ì†ë„ ì¸¡ë©´ì—ì„œ ë¹„êµë¥¼ í•´ë³´ì§€ëŠ” ì•Šì•˜ìŠµë‹ˆë‹¤ë§Œ, ìµœê·¼ `pandas 1.3.0` ë²„ì „ ë¶€í„°ëŠ” ì—¬ëŸ¬ ì¹¼ëŸ¼ì„ explodeí•´ì£¼ëŠ” ê¸°ëŠ¥ì„ ì§€ì›í•œë‹¤ê³  í•©ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ [Pandas ê³µì‹ ë¬¸ì„œ](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.explode.html)ë¥¼ í™•ì¸í•´ ë³´ì‹œê¸¸ ë°”ëë‹ˆë‹¤.